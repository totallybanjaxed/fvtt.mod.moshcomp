{"_id":"LeGtTUGWcJJQCzYy","name":"Character Rollup","permission":{"default":0,"Nxy7peNOaZ1Quprg":3},"type":"chat","sort":100001,"flags":{},"scope":"global","command":"Character Rollup: \n\nRoll for Strength [[6d10]]\nRoll for Speed [[6d10]]\nRoll for Intellect [[6d10]]\nRoll for Combat [[6d10]]","author":"Nxy7peNOaZ1Quprg","img":"icons/svg/dice-target.svg","actorIds":[]}
{"name":"1d10 roll","permission":{"default":0,"Nxy7peNOaZ1Quprg":3},"type":"chat","flags":{"core":{"sourceId":"Macro.rolSYaRyITFN7V1O"}},"scope":"global","command":"Standard [[1d10]] roll","author":"Nxy7peNOaZ1Quprg","img":"icons/svg/d10-grey.svg","actorIds":[],"_id":"ZxYJpYEQPqewTJcu"}
{"_id":"g0L9Mpsmx2muvwtX","name":"Chat Panic","permission":{"default":0,"U4nUp29rqOaQo1MQ":3},"type":"script","flags":{"core":{"sourceId":"Macro.ccTESwfP2bwzZSPm"}},"scope":"global","command":"main();\n\n\nasync function main() {\n    // See if a token is controlled\n    console.log(\"Tokens: \", canvas.tokens.controlled);\n    if (canvas.tokens.controlled.length == 0 || canvas.tokens.controlled.length > 1) {\n        ui.notifications.error(\"Please select a single token\");\n        return;\n    }\n\n\n    let rolldata = token.actor.getRollData();\n    let stress = rolldata.other.stress.value;\n    let check = new Roll('2d10');\n    let checkresult = check.roll()._total;\n\n\n    if (checkresult > stress) {\n        let token = canvas.tokens.controlled[0];\n        let actor = token.actor;\n        if (stress > actor.data.data.other.stress.min) {\n            actor.update({ \"data.other.stress.value\": actor.data.data.other.stress.value - 1 });\n            let chatData = {\n                user: game.user._id,\n                content: '<div style=\\\"background-color: white\\\"><br><h2 style=\\\"color: green\">Panic Check: Success</h2><p>Panic Check: ' + checkresult + '</p><p>You remained cool under pressure.<br>Your stress has been reduced by 1.</p></div>'\n            };\n            ChatMessage.create(chatData);\n        } else {\n            let chatData = {\n                user: game.user._id,\n                content: '<div style=\\\"background-color: white\\\"><br><h2 style=\\\"color: green\">Panic Check: Success</h2><p>Panic Check: ' + checkresult + '</p><p>Do you ever get flustered?<br><br>Your stress levels appear to be as low as it gets...for you at least!</p></div>'\n            };\n            ChatMessage.create(chatData);\n        }\n\n    } else {\n        const panicroll = new Roll('2d10');\n        let panic = panicroll.roll()._total + stress;\n        if (panic > 30) {\n            var panicvalue = 30;\n        } else {\n            var panicvalue = panic;\n        }\n\n        let table = game.tables.entities.find(t => t.name === \"Panic Effects\");\n        let panic_result = table.data.results[panicvalue];\n        let chatData = {\n            user: game.user._id,\n            content: '<div style=\\\"background-color: white\\\"><br><h2 style=\\\"color: red\\\">Panic Check: Failure</h2><p>Panic Check: ' + checkresult + '</p><br>Panic Table Roll: ' + panicvalue + '<br><p>' + panic_result.text + '</p></div>'\n        };\n        ChatMessage.create(chatData);\n    }\n}","author":"U4nUp29rqOaQo1MQ","img":"modules/MotherShipCompendium/images/icons/misc/panic.jpg","actorIds":[]}
